import 'package:chatbot_allen/color_pallet.dart';import 'package:chatbot_allen/openai_services.dart';import 'package:flutter/material.dart';import 'package:flutter_svg/flutter_svg.dart';import 'package:speech_to_text/speech_recognition_result.dart';import 'package:speech_to_text/speech_to_text.dart';import 'featureBox.dart';class HomePage extends StatefulWidget {  @override  State<HomePage> createState() => _HomePageState();}class _HomePageState extends State<HomePage> {  String lastWords = '';  SpeechToText textToSpeech = SpeechToText();  OpenAIService openAIService = OpenAIService();  TextEditingController promptTextFieldController = TextEditingController();  @override  void initState() {    super.initState();    textToSpeechInitialization();  }  Future<void> textToSpeechInitialization() async{    await textToSpeech.initialize(      onStatus: (status) {                },    );    setState(() {});  }  /// Each time to start a speech recognition session  Future<void> startListening() async {    await textToSpeech.listen(        onResult: onSpeechResult,    );    setState(() {    });  }  Future<void> stopListening() async {    await openAIService.GeminiAPItest("What is the definition of flutter");    await textToSpeech.stop();    setState((){});  }  void onSpeechResult(SpeechRecognitionResult result) {    setState(() {      lastWords = result.recognizedWords;      print(lastWords);    });  }  @override  void dispose() {    super.dispose();    textToSpeech.stop();  }  @override  Widget build(BuildContext context) {    return Scaffold(      appBar: AppBar(        backgroundColor: Colors.white,        centerTitle: true,        surfaceTintColor: Colors.white,        title: const Text(          'ChatBot-Allen',          style: TextStyle(            fontSize: 19,            fontFamily: 'Cera Pro',            color: Colors.black,          ),        ),        leading: const Icon(Icons.menu),      ),      body: Container(        color: Colors.white,        child: SingleChildScrollView(child: Column(          mainAxisAlignment: MainAxisAlignment.start,          crossAxisAlignment: CrossAxisAlignment.center,          children: [            //ChatBot-Allen Logo SVG            Center(                child: Container(                  margin: const EdgeInsets.only(top: 5),                  width: 120,                  height: 120,                  padding: const EdgeInsets.all(20),                  decoration: const BoxDecoration(                    shape: BoxShape.circle,                    color: Pallet.assistantCircleColor,                  ),                  child: SvgPicture.asset(                    'assets/images/robot.svg',                  )                ),            ),            //Greeting-Box Chat Bubble            Container(              padding:const EdgeInsets.symmetric(                horizontal:20,                vertical:10,              ),              margin:const EdgeInsets.symmetric(                horizontal:30,              ).copyWith(                top:25,                ),              decoration:BoxDecoration(                color:Pallet.whiteColor,                border:Border.all(                  color:Pallet.borderColor,                ),                borderRadius:const BorderRadius.all(                  Radius.circular(20),                ).copyWith(                  topLeft:const Radius.circular(0)                )              ),              child:const Text(                'Good Morning, what task can I do for you?',                style: TextStyle(                  fontSize: 22,                  color: Pallet.mainFontColor,                  fontFamily: 'Cera Pro'                ),              ),            ),            //Suggestion title            Container(              alignment: Alignment.centerLeft,              margin:const EdgeInsets.only(left: 10,top: 10),              padding: const EdgeInsets.all(10),              child:const Text(                'Here are few features',                style: TextStyle(                  fontSize: 16,                  color: Pallet.mainFontColor,                  fontFamily: 'Cera Pro',                ),            )),            //Suggestion List            Column(              mainAxisAlignment: MainAxisAlignment.start,              crossAxisAlignment: CrossAxisAlignment.center,              children: [                FeatureBox(title: 'ChatGPT', boxColor: Pallet.firstSuggestionBoxColor,descriptionText: 'A smarter way to stay organized and informed with ChatGPT',),                FeatureBox(title: 'Dall-E', boxColor: Pallet.secondSuggestionBoxColor,descriptionText: 'Get inspired and stay creative with your personal assistant powered by Dall-E',),                FeatureBox(title: 'Smart Voice Assistant', boxColor: Pallet.thirdSuggestionBoxColor,descriptionText: 'Get the best of both worlds with a voice assistant powered by Dall-E and ChatGPT',),                FeatureBox(title: 'Smart Voice Assistant', boxColor: Pallet.thirdSuggestionBoxColor,descriptionText: 'Get the best of both worlds with a voice assistant powered by Dall-E and ChatGPT',)              ],            )          ],        )),      ),      floatingActionButtonLocation: FloatingActionButtonLocation.centerDocked,      floatingActionButton: Container(        color: Colors.white,          width: double.infinity,          child: Container(            height: 40,            margin:const EdgeInsets.symmetric(horizontal: 20,vertical: 10),            decoration: BoxDecoration(              color: Colors.grey.shade300,              borderRadius:const BorderRadius.all(Radius.circular(15))            ),              child: Row(            mainAxisAlignment: MainAxisAlignment.center,            crossAxisAlignment: CrossAxisAlignment.center,            children: [              Expanded(                  child: Container(                child: TextField(                  cursorColor: Colors.black,                  controller: promptTextFieldController,                  onChanged: (value){                  },                  decoration:const InputDecoration(                    hintText: 'Message',                    contentPadding: EdgeInsets.symmetric(vertical: 5,horizontal: 10),                    enabledBorder:OutlineInputBorder(                        borderSide: BorderSide(color: Colors.transparent,width: 0)                    ),                    focusedBorder:OutlineInputBorder(                        borderSide: BorderSide(color: Colors.transparent,width: 0)                    )                  )                ),              )),              InkWell(                splashColor: Colors.white,                child:Container(                  padding:const EdgeInsets.all(10),                    child: Icon(textToSpeech.isNotListening?Icons.mic:Icons.fiber_manual_record)),                onTap: ()async{                  if(await textToSpeech.hasPermission && textToSpeech.isNotListening){                    await startListening();                  }else if(textToSpeech.isListening){                    await stopListening();                  }else{                    textToSpeechInitialization();                  }                  setState(() {});                },              ),            ],      ))),    );  }}